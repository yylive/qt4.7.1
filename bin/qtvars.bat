@echo off
rem
rem This file is generated by the Qt installer
rem

rem %1 vsvars
rem %2 vs2013/vs2015

echo Setting up a Qt environment...

for %%I in ("%~dp0\..") do set QTDIR=%%~fI

echo -- QTDIR set to %QTDIR%
set PATH=%QTDIR%\bin;%PATH%
echo -- Added %QTDIR%\bin to PATH

set VS_Type=vs2008
set VS_Plat=x86

if "%2" == "vs2008_x64" (
    set VS_Type=vs2008
    set VS_Plat=x64
)

if "%2" == "vs2015" (
set VS_Type=vs2015
set VS_Plat=x86
)

if "%2" == "vs2015_x64" (
set VS_Type=vs2015
set VS_Plat=x64
)

echo "VS_Type=%VS_Type%"
echo "VS_Plat=%VS_Plat%"

rem do vs2015 environment
if "%VS_Type%" == "vs2015" (
set QMAKESPEC=win32-msvc2010
echo -- QMAKESPEC set to "win32-msvc2010"

if not "%VS140COMNTOOLS%"=="" (
    set "VS_COMMON_TOOLS=%VS140COMNTOOLS%"
)
)

rem do vs2008 environment
if "%VS_Type%" == "vs2008" (
set QMAKESPEC=win32-msvc2008
echo -- QMAKESPEC set to "win32-msvc2008"

if not "%VS90COMNTOOLS%"=="" (
    set "VS_COMMON_TOOLS=%VS90COMNTOOLS%"
)
)

if not "%1"=="vsvars" goto ENDVSVARS

set VS_X64_File=""
if "%VS_Type%" == "vs2008" (set VS_X64_File=../../VC/bin/amd64/vcvarsamd64.bat)
if "%VS_Type%" == "vs2015" (set VS_X64_File=../../VC/bin/amd64/vcvars64.bat)

if "%VS_Plat%" == "x86" (
call "%VS_COMMON_TOOLS%vsvars32.bat"
) else if "%VS_Plat%" == "x64" (
call "%VS_COMMON_TOOLS%%VS_X64_File%"
)

:ENDVSVARS

if not "%1"=="vsstart" goto ENDVSSTART
call "%VS_COMMON_TOOLS%vsvars32.bat"
devenv /useenv
:ENDVSSTART
