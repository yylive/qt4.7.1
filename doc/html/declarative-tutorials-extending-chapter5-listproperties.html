<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en_US" lang="en_US">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<!-- extending-tutorial.qdoc -->
  <title>Qt 4.7: Chapter 5: Using List Property Types</title>
  <link rel="stylesheet" type="text/css" href="style/style.css" />
  <script src="scripts/jquery.js" type="text/javascript"></script>
  <script src="scripts/functions.js" type="text/javascript"></script>
</head>
<body class="offline narrow creator">
 <div class="header" id="qtdocheader">
    <div class="content"> 
    <div id="nav-logo">
      <a href="index.html">Home</a></div>
    <a href="index.html" class="qtref"><span>Qt Reference Documentation</span></a>
    <div id="nav-topright">
      <ul>
        <li class="nav-topright-home"><a href="http://qt.nokia.com/">Qt HOME</a></li>
        <li class="nav-topright-dev"><a href="http://developer.qt.nokia.com/">DEV</a></li>
        <li class="nav-topright-labs"><a href="http://labs.qt.nokia.com/blogs/">LABS</a></li>
        <li class="nav-topright-doc nav-topright-doc-active"><a href="http://doc.qt.nokia.com/">
          DOC</a></li>
        <li class="nav-topright-blog"><a href="http://blog.qt.nokia.com/">BLOG</a></li>
      </ul>
    </div>
    <div id="shortCut">
      <ul>
        <li class="shortCut-topleft-inactive"><span><a href="index.html">Qt 4.7</a></span></li>
        <li class="shortCut-topleft-active"><a href="http://doc.qt.nokia.com">ALL VERSIONS        </a></li>
      </ul>
     </div>
 <ul class="sf-menu sf-js-enabled sf-shadow" id="narrowmenu"> 
		 <li><a href="#">API Lookup</a> 
			 <ul id="topmenuLook"> 
			   <li><a href="classes.html">Class index</a></li> 
 			  <li><a href="functions.html">Function index</a></li> 
			   <li><a href="modules.html">Modules</a></li> 
			   <li><a href="namespaces.html">Namespaces</a></li> 
			   <li><a href="qtglobal.html">Global Declarations</a></li> 
			   <li><a href="licensing.html">Licenses and Credits</a></li> 
			   </ul> 
		 </li> 
		 <li><a href="#">Qt Topics</a> 
			 <ul id="topmenuTopic"> 
			   <li><a href="qt-basic-concepts.html">Programming with Qt</a></li> 
			   <li><a href="qtquick.html">Device UI's &amp; Qt Quick</a></li> 
			   <li><a href="qt-gui-concepts.html">UI Design with Qt</a></li> 
			   <li><a href="developing-with-qt.html">Cross-platform and Platform-specific</a></li> 
			   <li><a href="platform-specific.html">Platform-specific info</a></li> 
			   <li><a href="technology-apis.html">Qt and Key Technologies</a></li> 
			   <li><a href="best-practices.html">How-To's and Best Practices</a></li> 
			 </ul> 
		</li> 
		 <li><a href="#">Examples</a> 
			 <ul id="topmenuexample"> 
				 <li><a href="all-examples.html">Examples</a></li> 
				 <li><a href="tutorials.html">Tutorials</a></li> 
				 <li><a href="demos.html">Demos</a></li> 
				 <li><a href="qdeclarativeexamples.html">QML Examples</a></li> 
			 </ul> 
		 </li> 
 </ul> 
    </div>
  </div>
  <div class="wrapper">
    <div class="hd">
      <span></span>
    </div>
    <div class="bd group">
      <div class="sidebar">
        <div class="searchlabel">
          Search index:</div>
        <div class="search">
          <form id="qtdocsearch" action="" onsubmit="return false;">
            <fieldset>
              <input type="text" name="searchstring" id="pageType" value="" />
            </fieldset>
          </form>
        </div>
        <div class="box first bottombar" id="lookup">
          <h2 title="API Lookup"><span></span>
            API Lookup</h2>
          <div  id="list001" class="list">
          <ul id="ul001" >
              <li class="defaultLink"><a href="classes.html">Class index</a></li>
              <li class="defaultLink"><a href="functions.html">Function index</a></li>
              <li class="defaultLink"><a href="modules.html">Modules</a></li>
              <li class="defaultLink"><a href="namespaces.html">Namespaces</a></li>
              <li class="defaultLink"><a href="qtglobal.html">Global Declarations</a></li>
              <li class="defaultLink"><a href="qdeclarativeelements.html">QML elements</a></li>
            </ul> 
          </div>
        </div>
        <div class="box bottombar" id="topics">
          <h2 title="Qt Topics"><span></span>
            Qt Topics</h2>
          <div id="list002" class="list">
            <ul id="ul002" >
			   <li class="defaultLink"><a href="qt-basic-concepts.html">Programming with Qt</a></li> 
			   <li class="defaultLink"><a href="qtquick.html">Device UI's &amp; Qt Quick</a></li> 
			   <li class="defaultLink"><a href="qt-gui-concepts.html">UI Design with Qt</a></li> 
			   <li class="defaultLink"><a href="developing-with-qt.html">Cross-platform and Platform-specific</a></li> 
			   <li class="defaultLink"><a href="platform-specific.html">Platform-specific info</a></li> 
			   <li class="defaultLink"><a href="technology-apis.html">Qt and Key Technologies</a></li> 
			   <li class="defaultLink"><a href="best-practices.html">How-To's and Best Practices</a></li> 
            </ul>  
          </div>
        </div>
        <div class="box" id="examples">
          <h2 title="Examples"><span></span>
            Examples</h2>
          <div id="list003" class="list">
        <ul id="ul003">
              <li class="defaultLink"><a href="all-examples.html">Examples</a></li>
              <li class="defaultLink"><a href="tutorials.html">Tutorials</a></li>
              <li class="defaultLink"><a href="demos.html">Demos</a></li>
              <li class="defaultLink"><a href="qdeclarativeexamples.html">QML Examples</a></li>
            </ul> 
          </div>
        </div>
      </div>
      <div class="wrap">
        <div class="toolbar">
          <div class="breadcrumb toolblock">
            <ul>
              <li class="first"><a href="index.html">Home</a></li>
              <!--  Bread crumbs goes here -->
              <li><a href="all-examples.html">Examples</a></li>              <li><a href="qdeclarativeexamples.html">QML Examples &amp; Demos</a></li>              <li>Chapter 5: Using List Property Types</li>            </ul>
          </div>
          <div class="toolbuttons toolblock">
            <ul>
              <li id="smallA" class="t_button">A</li>
              <li id="medA" class="t_button active">A</li>
              <li id="bigA" class="t_button">A</li>
              <li id="print" class="t_button"><a href="javascript:this.print();">
                <span>Print</span></a></li>
            </ul>
        </div>
        </div>
        <div class="content">
<h1 class="title">Chapter 5: Using List Property Types</h1>
<span class="subtitle"></span>
<!-- $$$declarative/tutorials/extending/chapter5-listproperties-description -->
<div class="descr"> <a name="details"></a>
<p>Files:</p>
<ul>
<li><a href="declarative-tutorials-extending-chapter5-listproperties-app-qml.html">declarative/tutorials/extending/chapter5-listproperties/app.qml</a></li>
<li><a href="declarative-tutorials-extending-chapter5-listproperties-piechart-cpp.html">declarative/tutorials/extending/chapter5-listproperties/piechart.cpp</a></li>
<li><a href="declarative-tutorials-extending-chapter5-listproperties-piechart-h.html">declarative/tutorials/extending/chapter5-listproperties/piechart.h</a></li>
<li><a href="declarative-tutorials-extending-chapter5-listproperties-pieslice-cpp.html">declarative/tutorials/extending/chapter5-listproperties/pieslice.cpp</a></li>
<li><a href="declarative-tutorials-extending-chapter5-listproperties-pieslice-h.html">declarative/tutorials/extending/chapter5-listproperties/pieslice.h</a></li>
<li><a href="declarative-tutorials-extending-chapter5-listproperties-main-cpp.html">declarative/tutorials/extending/chapter5-listproperties/main.cpp</a></li>
<li><a href="declarative-tutorials-extending-chapter5-listproperties-chapter5-listproperties-pro.html">declarative/tutorials/extending/chapter5-listproperties/chapter5-listproperties.pro</a></li>
</ul>
<p>Right now, a <tt>PieChart</tt> can only have one <tt>PieSlice</tt>. Ideally a chart would have multiple slices, with different colors and sizes. To do this, we could have a <tt>slices</tt> property that accepts a list of <tt>PieSlice</tt> items:</p>
<pre class="highlightedCode brush: cpp"> import Charts 1.0
 import QtQuick 1.0

 Item {
     width: 300; height: 200

     PieChart {
         anchors.centerIn: parent
         width: 100; height: 100

         slices: [
             PieSlice {
                 anchors.fill: parent
                 color: &quot;red&quot;
                 fromAngle: 0; angleSpan: 110
             },
             PieSlice {
                 anchors.fill: parent
                 color: &quot;black&quot;
                 fromAngle: 110; angleSpan: 50
             },
             PieSlice {
                 anchors.fill: parent
                 color: &quot;blue&quot;
                 fromAngle: 160; angleSpan: 100
             }
         ]
     }
 }</pre>
<p class="centerAlign"><img src="images/extending-tutorial-chapter5.png" /></p><p>To do this, we replace the <tt>pieSlice</tt> property in <tt>PieChart</tt> with a <tt>slices</tt> property, declared as a <a href="qdeclarativelistproperty.html">QDeclarativeListProperty</a> type. The <a href="qdeclarativelistproperty.html">QDeclarativeListProperty</a> class enables the creation of list properties in QML extensions. We replace the <tt>pieSlice()</tt> function with a <tt>slices()</tt> function that returns a list of slices, and add an internal <tt>append_slice()</tt> function (discussed below). We also use a <a href="qlist.html">QList</a> to store the internal list of slices as <tt>m_slices</tt>:</p>
<pre class="highlightedCode brush: cpp"> class PieChart : public QDeclarativeItem
 {
     Q_OBJECT
     Q_PROPERTY(QDeclarativeListProperty&lt;PieSlice&gt; slices READ slices)
     ...
 public:
     ...
     QDeclarativeListProperty&lt;PieSlice&gt; slices();

 private:
     static void append_slice(QDeclarativeListProperty&lt;PieSlice&gt; *list, PieSlice *slice);

     QString m_name;
     QList&lt;PieSlice *&gt; m_slices;
 };</pre>
<p>Although the <tt>slices</tt> property does not have an associated <tt>WRITE</tt> function, it is still modifiable because of the way <a href="qdeclarativelistproperty.html">QDeclarativeListProperty</a> works. In the <tt>PieChart</tt> implementation, we implement <tt>PieChart::slices()</tt> to return a <a href="qdeclarativelistproperty.html">QDeclarativeListProperty</a> value and indicate that the internal <tt>PieChart::append_slice()</tt> function is to be called whenever a request is made from QML to add items to the list:</p>
<pre class="highlightedCode brush: cpp"> QDeclarativeListProperty&lt;PieSlice&gt; PieChart::slices()
 {
     return QDeclarativeListProperty&lt;PieSlice&gt;(this, 0, &amp;PieChart::append_slice);
 }

 void PieChart::append_slice(QDeclarativeListProperty&lt;PieSlice&gt; *list, PieSlice *slice)
 {
     PieChart *chart = qobject_cast&lt;PieChart *&gt;(list-&gt;object);
     if (chart) {
         slice-&gt;setParentItem(chart);
         chart-&gt;m_slices.append(slice);
     }
 }</pre>
<p>The <tt>append_slice()</tt> function simply sets the parent item as before, and adds the new item to the <tt>m_slices</tt> list. As you can see, the append function for a <a href="qdeclarativelistproperty.html">QDeclarativeListProperty</a> is called with two arguments: the list property, and the item that is to be appended.</p>
<p>The <tt>PieSlice</tt> class has also been modified to include <tt>fromAngle</tt> and <tt>angleSpan</tt> properties and to draw the slice according to these values. This is a straightforward modification if you have read the previous pages in this tutorial, so the code is not shown here.</p>
<p>The complete code can be seen in the updated <tt>examples/tutorials/extending/chapter5-listproperties</tt> directory.</p>
</div>
<!-- @@@declarative/tutorials/extending/chapter5-listproperties -->
        <div class="feedback t_button">
          [+] Documentation Feedback</div>
      </div>
    </div>
    </div> 
    <div class="ft">
      <span></span>
    </div>
  </div> 
  <div class="footer">
    <p>
      <acronym title="Copyright">&copy;</acronym> 2008-2010 Nokia Corporation and/or its
      subsidiaries. Nokia, Qt and their respective logos are trademarks of Nokia Corporation 
      in Finland and/or other countries worldwide.</p>
    <p>
      All other trademarks are property of their respective owners. <a title="Privacy Policy"
        href="http://qt.nokia.com/about/privacy-policy">Privacy Policy</a></p>
    <br />
    <p>
      Licensees holding valid Qt Commercial licenses may use this document in accordance with the      Qt Commercial License Agreement provided with the Software or, alternatively, in accordance      with the terms contained in a written agreement between you and Nokia.</p>
    <p>
      Alternatively, this document may be used under the terms of the <a href="http://www.gnu.org/licenses/fdl.html">GNU
      Free Documentation License version 1.3</a>
      as published by the Free Software Foundation.</p>
  </div>
  <div id="feedbackBox">
      <div id="feedcloseX" class="feedclose t_button">X</div>
    <form id="feedform" action="http://doc.qt.nokia.com/docFeedbck/feedback.php" method="get">
      <p id="noteHead">Thank you for giving your feedback.</p> <p class="note">Make sure it is related to this specific page. For more general bugs and 
      requests, please use the <a href="http://bugreports.qt.nokia.com/secure/Dashboard.jspa">Qt Bug Tracker</a>.</p>
      <p><textarea id="feedbox" name="feedText" rows="5" cols="40"></textarea></p>
      <p><input id="feedsubmit" class="feedclose" type="submit" name="feedback" /></p>
    </form>
  </div>
  <div id="blurpage">
  </div>
</body>
</html>
