<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en_US" lang="en_US">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<!-- qdeclarativeimageprovider.cpp -->
  <title>Qt 4.7: QDeclarativeImageProvider Class Reference</title>
  <link rel="stylesheet" type="text/css" href="style/style.css" />
  <script src="scripts/jquery.js" type="text/javascript"></script>
  <script src="scripts/functions.js" type="text/javascript"></script>
</head>
<body class="offline narrow creator">
 <div class="header" id="qtdocheader">
    <div class="content"> 
    <div id="nav-logo">
      <a href="index.html">Home</a></div>
    <a href="index.html" class="qtref"><span>Qt Reference Documentation</span></a>
    <div id="nav-topright">
      <ul>
        <li class="nav-topright-home"><a href="http://qt.nokia.com/">Qt HOME</a></li>
        <li class="nav-topright-dev"><a href="http://developer.qt.nokia.com/">DEV</a></li>
        <li class="nav-topright-labs"><a href="http://labs.qt.nokia.com/blogs/">LABS</a></li>
        <li class="nav-topright-doc nav-topright-doc-active"><a href="http://doc.qt.nokia.com/">
          DOC</a></li>
        <li class="nav-topright-blog"><a href="http://blog.qt.nokia.com/">BLOG</a></li>
      </ul>
    </div>
    <div id="shortCut">
      <ul>
        <li class="shortCut-topleft-inactive"><span><a href="index.html">Qt 4.7</a></span></li>
        <li class="shortCut-topleft-active"><a href="http://doc.qt.nokia.com">ALL VERSIONS        </a></li>
      </ul>
     </div>
 <ul class="sf-menu sf-js-enabled sf-shadow" id="narrowmenu"> 
		 <li><a href="#">API Lookup</a> 
			 <ul id="topmenuLook"> 
			   <li><a href="classes.html">Class index</a></li> 
 			  <li><a href="functions.html">Function index</a></li> 
			   <li><a href="modules.html">Modules</a></li> 
			   <li><a href="namespaces.html">Namespaces</a></li> 
			   <li><a href="qtglobal.html">Global Declarations</a></li> 
			   <li><a href="licensing.html">Licenses and Credits</a></li> 
			   </ul> 
		 </li> 
		 <li><a href="#">Qt Topics</a> 
			 <ul id="topmenuTopic"> 
			   <li><a href="qt-basic-concepts.html">Programming with Qt</a></li> 
			   <li><a href="qtquick.html">Device UI's &amp; Qt Quick</a></li> 
			   <li><a href="qt-gui-concepts.html">UI Design with Qt</a></li> 
			   <li><a href="developing-with-qt.html">Cross-platform and Platform-specific</a></li> 
			   <li><a href="platform-specific.html">Platform-specific info</a></li> 
			   <li><a href="technology-apis.html">Qt and Key Technologies</a></li> 
			   <li><a href="best-practices.html">How-To's and Best Practices</a></li> 
			 </ul> 
		</li> 
		 <li><a href="#">Examples</a> 
			 <ul id="topmenuexample"> 
				 <li><a href="all-examples.html">Examples</a></li> 
				 <li><a href="tutorials.html">Tutorials</a></li> 
				 <li><a href="demos.html">Demos</a></li> 
				 <li><a href="qdeclarativeexamples.html">QML Examples</a></li> 
			 </ul> 
		 </li> 
 </ul> 
    </div>
  </div>
  <div class="wrapper">
    <div class="hd">
      <span></span>
    </div>
    <div class="bd group">
      <div class="sidebar">
        <div class="searchlabel">
          Search index:</div>
        <div class="search">
          <form id="qtdocsearch" action="" onsubmit="return false;">
            <fieldset>
              <input type="text" name="searchstring" id="pageType" value="" />
            </fieldset>
          </form>
        </div>
        <div class="box first bottombar" id="lookup">
          <h2 title="API Lookup"><span></span>
            API Lookup</h2>
          <div  id="list001" class="list">
          <ul id="ul001" >
              <li class="defaultLink"><a href="classes.html">Class index</a></li>
              <li class="defaultLink"><a href="functions.html">Function index</a></li>
              <li class="defaultLink"><a href="modules.html">Modules</a></li>
              <li class="defaultLink"><a href="namespaces.html">Namespaces</a></li>
              <li class="defaultLink"><a href="qtglobal.html">Global Declarations</a></li>
              <li class="defaultLink"><a href="qdeclarativeelements.html">QML elements</a></li>
            </ul> 
          </div>
        </div>
        <div class="box bottombar" id="topics">
          <h2 title="Qt Topics"><span></span>
            Qt Topics</h2>
          <div id="list002" class="list">
            <ul id="ul002" >
			   <li class="defaultLink"><a href="qt-basic-concepts.html">Programming with Qt</a></li> 
			   <li class="defaultLink"><a href="qtquick.html">Device UI's &amp; Qt Quick</a></li> 
			   <li class="defaultLink"><a href="qt-gui-concepts.html">UI Design with Qt</a></li> 
			   <li class="defaultLink"><a href="developing-with-qt.html">Cross-platform and Platform-specific</a></li> 
			   <li class="defaultLink"><a href="platform-specific.html">Platform-specific info</a></li> 
			   <li class="defaultLink"><a href="technology-apis.html">Qt and Key Technologies</a></li> 
			   <li class="defaultLink"><a href="best-practices.html">How-To's and Best Practices</a></li> 
            </ul>  
          </div>
        </div>
        <div class="box" id="examples">
          <h2 title="Examples"><span></span>
            Examples</h2>
          <div id="list003" class="list">
        <ul id="ul003">
              <li class="defaultLink"><a href="all-examples.html">Examples</a></li>
              <li class="defaultLink"><a href="tutorials.html">Tutorials</a></li>
              <li class="defaultLink"><a href="demos.html">Demos</a></li>
              <li class="defaultLink"><a href="qdeclarativeexamples.html">QML Examples</a></li>
            </ul> 
          </div>
        </div>
      </div>
      <div class="wrap">
        <div class="toolbar">
          <div class="breadcrumb toolblock">
            <ul>
              <li class="first"><a href="index.html">Home</a></li>
              <!--  Bread crumbs goes here -->
              <li><a href="modules.html">Modules</a></li>              <li><a href="qtdeclarative.html">QtDeclarative</a></li>
              <li>QDeclarativeImageProvider</li>
            </ul>
          </div>
          <div class="toolbuttons toolblock">
            <ul>
              <li id="smallA" class="t_button">A</li>
              <li id="medA" class="t_button active">A</li>
              <li id="bigA" class="t_button">A</li>
              <li id="print" class="t_button"><a href="javascript:this.print();">
                <span>Print</span></a></li>
            </ul>
        </div>
        </div>
        <div class="content">
<div class="toc">
<h3><a name="toc">Contents</a></h3>
<ul>
<li class="level1"><a href="#public-types">Public Types</a></li>
<li class="level1"><a href="#public-functions">Public Functions</a></li>
<li class="level1"><a href="#details">Detailed Description</a></li>
<li class="level2"><a href="#an-example">An example</a></li>
<li class="level2"><a href="#asynchronous-image-loading">Asynchronous image loading</a></li>
</ul>
</div>
<h1 class="title">QDeclarativeImageProvider Class Reference</h1>
<!-- $$$QDeclarativeImageProvider-brief -->
<p>The QDeclarativeImageProvider class provides an interface for supporting pixmaps and threaded image requests in QML. <a href="#details">More...</a></p>
<!-- @@@QDeclarativeImageProvider -->
<pre class="highlightedCode brush: cpp"> #include &lt;QDeclarativeImageProvider&gt;</pre><p>This class was introduced in Qt 4.7.</p>
<ul>
<li><a href="qdeclarativeimageprovider-members.html">List of all members, including inherited members</a></li>
</ul>
<a name="public-types"></a>
<h2>Public Types</h2>
<table class="alignedsummary">
<tr><td class="memItemLeft rightAlign topAlign"> enum </td><td class="memItemRight bottomAlign"><b><a href="qdeclarativeimageprovider.html#ImageType-enum">ImageType</a></b> { Image, Pixmap }</td></tr>
</table>
<a name="public-functions"></a>
<h2>Public Functions</h2>
<table class="alignedsummary">
<tr><td class="memItemLeft rightAlign topAlign"> </td><td class="memItemRight bottomAlign"><b><a href="qdeclarativeimageprovider.html#QDeclarativeImageProvider">QDeclarativeImageProvider</a></b> ( ImageType <i>type</i> )</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> virtual </td><td class="memItemRight bottomAlign"><b><a href="qdeclarativeimageprovider.html#dtor.QDeclarativeImageProvider">~QDeclarativeImageProvider</a></b> ()</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> ImageType </td><td class="memItemRight bottomAlign"><b><a href="qdeclarativeimageprovider.html#imageType">imageType</a></b> () const</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> virtual QImage </td><td class="memItemRight bottomAlign"><b><a href="qdeclarativeimageprovider.html#requestImage">requestImage</a></b> ( const QString &amp; <i>id</i>, QSize * <i>size</i>, const QSize &amp; <i>requestedSize</i> )</td></tr>
<tr><td class="memItemLeft rightAlign topAlign"> virtual QPixmap </td><td class="memItemRight bottomAlign"><b><a href="qdeclarativeimageprovider.html#requestPixmap">requestPixmap</a></b> ( const QString &amp; <i>id</i>, QSize * <i>size</i>, const QSize &amp; <i>requestedSize</i> )</td></tr>
</table>
<a name="details"></a>
<!-- $$$QDeclarativeImageProvider-description -->
<div class="descr">
<h2>Detailed Description</h2>
<p>The QDeclarativeImageProvider class provides an interface for supporting pixmaps and threaded image requests in QML.</p>
<p>QDeclarativeImageProvider is used to provide advanced image loading features in QML applications. It allows images in QML to be:</p>
<ul>
<li>Loaded using QPixmaps rather than actual image files</li>
<li>Loaded asynchronously in a separate thread, if <a href="qdeclarativeimageprovider.html#imageType">imageType</a>() is <a href="qdeclarativeimageprovider.html#ImageType-enum">ImageType::Image</a></li>
</ul>
<p>To specify that an image should be loaded by an image provider, use the <b>&quot;image:&quot;</b> scheme for the URL source of the image, followed by the identifiers of the image provider and the requested image. For example:</p>
<pre class="highlightedCode brush: cpp"> Image { source: &quot;image://myimageprovider/image.png&quot; }</pre>
<p>This specifies that the image should be loaded by the image provider named &quot;myimageprovider&quot;, and the image to be loaded is named &quot;image.png&quot;. The QML engine invokes the appropriate image provider according to the providers that have been registered through <a href="qdeclarativeengine.html#addImageProvider">QDeclarativeEngine::addImageProvider</a>().</p>
<a name="an-example"></a>
<h3>An example</h3>
<p>Here are two images. Their <tt>source</tt> values indicate they should be loaded by an image provider named &quot;colors&quot;, and the images to be loaded are &quot;yellow&quot; and &quot;red&quot;, respectively:</p>
<pre class="highlightedCode brush: cpp"> Column {
     Image { source: &quot;image://colors/yellow&quot; }
     Image { source: &quot;image://colors/red&quot; }
 }</pre>
<p>When these images are loaded by QML, it looks for a matching image provider and calls its <a href="qdeclarativeimageprovider.html#requestImage">requestImage</a>() or <a href="qdeclarativeimageprovider.html#requestPixmap">requestPixmap</a>() method (depending on its <a href="qdeclarativeimageprovider.html#imageType">imageType</a>()) to load the image. The method is called with the <tt>id</tt> parameter set to &quot;yellow&quot; for the first image, and &quot;red&quot; for the second.</p>
<p>Here is an image provider implementation that can load the images requested by the above QML. This implementation dynamically generates <a href="qpixmap.html">QPixmap</a> images that are filled with the requested color:</p>
<pre class="highlightedCode brush: cpp"> class ColorImageProvider : public QDeclarativeImageProvider
 {
 public:
     ColorImageProvider()
         : QDeclarativeImageProvider(QDeclarativeImageProvider::Pixmap)
     {
     }

     QPixmap requestPixmap(const QString &amp;id, QSize *size, const QSize &amp;requestedSize)
     {
         int width = 100;
         int height = 50;

         if (size)
             *size = QSize(width, height);
         QPixmap pixmap(requestedSize.width() &gt; 0 ? requestedSize.width() : width,
                        requestedSize.height() &gt; 0 ? requestedSize.height() : height);
         pixmap.fill(QColor(id).rgba());

         return pixmap;
     }
 };</pre>
<p>To make this provider accessible to QML, it is registered with the QML engine with a &quot;colors&quot; identifier:</p>
<pre class="highlightedCode brush: cpp"> int main(int argc, char *argv[])
 {
     ...

     QDeclarativeEngine engine;
     engine-&gt;addImageProvider(QLatin1String(&quot;colors&quot;), new ColorPixmapProvider);

     ...
 }</pre>
<p>Now the images can be successfully loaded in QML:</p>
<p class="centerAlign"><img src="images/imageprovider.png" /></p><p>A complete example is available in Qt's <a href="declarative-cppextensions-imageprovider.html">examples/declarative/cppextensions/imageprovider</a> directory. Note the example registers the provider via a <a href="qdeclarativeextensionplugin.html">plugin</a> instead of registering it in the application <tt>main()</tt> function as shown above.</p>
<a name="asynchronous-image-loading"></a>
<h3>Asynchronous image loading</h3>
<p>Image providers that support <a href="qimage.html">QImage</a> loading automatically include support for asychronous loading of images. To enable asynchronous loading for an <a href="qdeclarativeimageprovider.html#ImageType-enum">Image</a> source, set <a href="qml-image.html#asynchronous-prop">Image::asynchronous</a> to <tt>true</tt>. When this is enabled, the image request to the provider is run in a low priority thread, allowing image loading to be executed in the background, and reducing the performance impact on the user interface.</p>
<p>Asynchronous loading is not supported for image providers that provide <a href="qpixmap.html">QPixmap</a> rather than <a href="qimage.html">QImage</a> values, as pixmaps can only be created in the main thread. In this case, if <a href="qml-image.html#asynchronous-prop">asynchronous</a> is set to <tt>true</tt>, the value is ignored and the image is loaded synchronously.</p>
</div>
<p>See also <a href="qdeclarativeengine.html#addImageProvider">QDeclarativeEngine::addImageProvider</a>().</p>
<!-- @@@QDeclarativeImageProvider -->
<div class="types">
<h2>Member Type Documentation</h2>
<!-- $$$ImageType$$$Image$$$Pixmap -->
<h3 class="fn"><a name="ImageType-enum"></a>enum QDeclarativeImageProvider::ImageType</h3>
<p>Defines the type of image supported by this image provider.</p>
<table class="valuelist"><tr class="odd"><tr><th class="tblConst">Constant</th><th class="tblval">Value</th><th class="tbldscr">Description</th></tr>
<tr><td  class="topAlign"><tt>QDeclarativeImageProvider::Image</tt></td><td class=" topAlign"><tt>0</tt></td><td  class="topAlign">The Image Provider provides <a href="qimage.html">QImage</a> images. The <a href="qdeclarativeimageprovider.html#requestImage">requestImage</a>() method will be called for all image requests.</td></tr>
<tr><td  class="topAlign"><tt>QDeclarativeImageProvider::Pixmap</tt></td><td class=" topAlign"><tt>1</tt></td><td  class="topAlign">The Image Provider provides <a href="qpixmap.html">QPixmap</a> images. The <a href="qdeclarativeimageprovider.html#requestPixmap">requestPixmap</a>() method will be called for all image requests.</td></tr>
</table>
<!-- @@@ImageType -->
</div>
<div class="func">
<h2>Member Function Documentation</h2>
<!-- $$$QDeclarativeImageProvider[overload1]$$$QDeclarativeImageProviderImageType -->
<h3 class="fn"><a name="QDeclarativeImageProvider"></a>QDeclarativeImageProvider::QDeclarativeImageProvider ( <a href="qdeclarativeimageprovider.html#ImageType-enum">ImageType</a> <i>type</i> )</h3>
<p>Creates an image provider that will provide images of the given <i>type</i>.</p>
<!-- @@@QDeclarativeImageProvider -->
<!-- $$$~QDeclarativeImageProvider[overload1]$$$~QDeclarativeImageProvider -->
<h3 class="fn"><a name="dtor.QDeclarativeImageProvider"></a>QDeclarativeImageProvider::~QDeclarativeImageProvider ()<tt> [virtual]</tt></h3>
<p>Destroys the <a href="qdeclarativeimageprovider.html">QDeclarativeImageProvider</a></p>
<p><b>Note:</b> The destructor of your derived class need to be thread safe.</p>
<!-- @@@~QDeclarativeImageProvider -->
<!-- $$$imageType[overload1]$$$imageType -->
<h3 class="fn"><a name="imageType"></a><a href="qdeclarativeimageprovider.html#ImageType-enum">ImageType</a> QDeclarativeImageProvider::imageType () const</h3>
<p>Returns the image type supported by this provider.</p>
<!-- @@@imageType -->
<!-- $$$requestImage[overload1]$$$requestImageconstQString&QSize*constQSize& -->
<h3 class="fn"><a name="requestImage"></a><a href="qimage.html">QImage</a> QDeclarativeImageProvider::requestImage ( const <a href="qstring.html">QString</a> &amp; <i>id</i>, <a href="qsize.html">QSize</a> * <i>size</i>, const <a href="qsize.html">QSize</a> &amp; <i>requestedSize</i> )<tt> [virtual]</tt></h3>
<p>Implement this method to return the image with <i>id</i>. The default implementation returns an empty image.</p>
<p>The <i>requestedSize</i> corresponds to the <a href="qml-image.html#sourceSize-prop">Image::sourceSize</a> requested by an Image element. If <i>requestedSize</i> is a valid size, the image returned should be of that size.</p>
<p>In all cases, <i>size</i> must be set to the original size of the image. This is used to set the <a href="qml-item.html#width-prop">width</a> and <a href="qml-item.html#height-prop">height</a> of image elements that should be automatically sized to the loaded image.</p>
<p><b>Note:</b> this method may be called by multiple threads, so ensure the implementation of this method is reentrant.</p>
<!-- @@@requestImage -->
<!-- $$$requestPixmap[overload1]$$$requestPixmapconstQString&QSize*constQSize& -->
<h3 class="fn"><a name="requestPixmap"></a><a href="qpixmap.html">QPixmap</a> QDeclarativeImageProvider::requestPixmap ( const <a href="qstring.html">QString</a> &amp; <i>id</i>, <a href="qsize.html">QSize</a> * <i>size</i>, const <a href="qsize.html">QSize</a> &amp; <i>requestedSize</i> )<tt> [virtual]</tt></h3>
<p>Implement this method to return the pixmap with <i>id</i>. The default implementation returns an empty pixmap.</p>
<p>The <i>requestedSize</i> corresponds to the <a href="qml-image.html#sourceSize-prop">Image::sourceSize</a> requested by an Image element. If <i>requestedSize</i> is a valid size, the image returned should be of that size.</p>
<p>In all cases, <i>size</i> must be set to the original size of the image. This is used to set the <a href="qml-item.html#width-prop">width</a> and <a href="qml-item.html#height-prop">height</a> of image elements that should be automatically sized to the loaded image.</p>
<!-- @@@requestPixmap -->
</div>
        <div class="feedback t_button">
          [+] Documentation Feedback</div>
      </div>
    </div>
    </div> 
    <div class="ft">
      <span></span>
    </div>
  </div> 
  <div class="footer">
    <p>
      <acronym title="Copyright">&copy;</acronym> 2008-2010 Nokia Corporation and/or its
      subsidiaries. Nokia, Qt and their respective logos are trademarks of Nokia Corporation 
      in Finland and/or other countries worldwide.</p>
    <p>
      All other trademarks are property of their respective owners. <a title="Privacy Policy"
        href="http://qt.nokia.com/about/privacy-policy">Privacy Policy</a></p>
    <br />
    <p>
      Licensees holding valid Qt Commercial licenses may use this document in accordance with the      Qt Commercial License Agreement provided with the Software or, alternatively, in accordance      with the terms contained in a written agreement between you and Nokia.</p>
    <p>
      Alternatively, this document may be used under the terms of the <a href="http://www.gnu.org/licenses/fdl.html">GNU
      Free Documentation License version 1.3</a>
      as published by the Free Software Foundation.</p>
  </div>
  <div id="feedbackBox">
      <div id="feedcloseX" class="feedclose t_button">X</div>
    <form id="feedform" action="http://doc.qt.nokia.com/docFeedbck/feedback.php" method="get">
      <p id="noteHead">Thank you for giving your feedback.</p> <p class="note">Make sure it is related to this specific page. For more general bugs and 
      requests, please use the <a href="http://bugreports.qt.nokia.com/secure/Dashboard.jspa">Qt Bug Tracker</a>.</p>
      <p><textarea id="feedbox" name="feedText" rows="5" cols="40"></textarea></p>
      <p><input id="feedsubmit" class="feedclose" type="submit" name="feedback" /></p>
    </form>
  </div>
  <div id="blurpage">
  </div>
</body>
</html>
