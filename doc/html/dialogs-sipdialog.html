<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en_US" lang="en_US">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<!-- sipdialog.qdoc -->
  <title>Qt 4.7: SIP Dialog Example</title>
  <link rel="stylesheet" type="text/css" href="style/style.css" />
  <script src="scripts/jquery.js" type="text/javascript"></script>
  <script src="scripts/functions.js" type="text/javascript"></script>
</head>
<body class="offline narrow creator">
 <div class="header" id="qtdocheader">
    <div class="content"> 
    <div id="nav-logo">
      <a href="index.html">Home</a></div>
    <a href="index.html" class="qtref"><span>Qt Reference Documentation</span></a>
    <div id="nav-topright">
      <ul>
        <li class="nav-topright-home"><a href="http://qt.nokia.com/">Qt HOME</a></li>
        <li class="nav-topright-dev"><a href="http://developer.qt.nokia.com/">DEV</a></li>
        <li class="nav-topright-labs"><a href="http://labs.qt.nokia.com/blogs/">LABS</a></li>
        <li class="nav-topright-doc nav-topright-doc-active"><a href="http://doc.qt.nokia.com/">
          DOC</a></li>
        <li class="nav-topright-blog"><a href="http://blog.qt.nokia.com/">BLOG</a></li>
      </ul>
    </div>
    <div id="shortCut">
      <ul>
        <li class="shortCut-topleft-inactive"><span><a href="index.html">Qt 4.7</a></span></li>
        <li class="shortCut-topleft-active"><a href="http://doc.qt.nokia.com">ALL VERSIONS        </a></li>
      </ul>
     </div>
 <ul class="sf-menu sf-js-enabled sf-shadow" id="narrowmenu"> 
		 <li><a href="#">API Lookup</a> 
			 <ul id="topmenuLook"> 
			   <li><a href="classes.html">Class index</a></li> 
 			  <li><a href="functions.html">Function index</a></li> 
			   <li><a href="modules.html">Modules</a></li> 
			   <li><a href="namespaces.html">Namespaces</a></li> 
			   <li><a href="qtglobal.html">Global Declarations</a></li> 
			   <li><a href="licensing.html">Licenses and Credits</a></li> 
			   </ul> 
		 </li> 
		 <li><a href="#">Qt Topics</a> 
			 <ul id="topmenuTopic"> 
			   <li><a href="qt-basic-concepts.html">Programming with Qt</a></li> 
			   <li><a href="qtquick.html">Device UI's &amp; Qt Quick</a></li> 
			   <li><a href="qt-gui-concepts.html">UI Design with Qt</a></li> 
			   <li><a href="developing-with-qt.html">Cross-platform and Platform-specific</a></li> 
			   <li><a href="platform-specific.html">Platform-specific info</a></li> 
			   <li><a href="technology-apis.html">Qt and Key Technologies</a></li> 
			   <li><a href="best-practices.html">How-To's and Best Practices</a></li> 
			 </ul> 
		</li> 
		 <li><a href="#">Examples</a> 
			 <ul id="topmenuexample"> 
				 <li><a href="all-examples.html">Examples</a></li> 
				 <li><a href="tutorials.html">Tutorials</a></li> 
				 <li><a href="demos.html">Demos</a></li> 
				 <li><a href="qdeclarativeexamples.html">QML Examples</a></li> 
			 </ul> 
		 </li> 
 </ul> 
    </div>
  </div>
  <div class="wrapper">
    <div class="hd">
      <span></span>
    </div>
    <div class="bd group">
      <div class="sidebar">
        <div class="searchlabel">
          Search index:</div>
        <div class="search">
          <form id="qtdocsearch" action="" onsubmit="return false;">
            <fieldset>
              <input type="text" name="searchstring" id="pageType" value="" />
            </fieldset>
          </form>
        </div>
        <div class="box first bottombar" id="lookup">
          <h2 title="API Lookup"><span></span>
            API Lookup</h2>
          <div  id="list001" class="list">
          <ul id="ul001" >
              <li class="defaultLink"><a href="classes.html">Class index</a></li>
              <li class="defaultLink"><a href="functions.html">Function index</a></li>
              <li class="defaultLink"><a href="modules.html">Modules</a></li>
              <li class="defaultLink"><a href="namespaces.html">Namespaces</a></li>
              <li class="defaultLink"><a href="qtglobal.html">Global Declarations</a></li>
              <li class="defaultLink"><a href="qdeclarativeelements.html">QML elements</a></li>
            </ul> 
          </div>
        </div>
        <div class="box bottombar" id="topics">
          <h2 title="Qt Topics"><span></span>
            Qt Topics</h2>
          <div id="list002" class="list">
            <ul id="ul002" >
			   <li class="defaultLink"><a href="qt-basic-concepts.html">Programming with Qt</a></li> 
			   <li class="defaultLink"><a href="qtquick.html">Device UI's &amp; Qt Quick</a></li> 
			   <li class="defaultLink"><a href="qt-gui-concepts.html">UI Design with Qt</a></li> 
			   <li class="defaultLink"><a href="developing-with-qt.html">Cross-platform and Platform-specific</a></li> 
			   <li class="defaultLink"><a href="platform-specific.html">Platform-specific info</a></li> 
			   <li class="defaultLink"><a href="technology-apis.html">Qt and Key Technologies</a></li> 
			   <li class="defaultLink"><a href="best-practices.html">How-To's and Best Practices</a></li> 
            </ul>  
          </div>
        </div>
        <div class="box" id="examples">
          <h2 title="Examples"><span></span>
            Examples</h2>
          <div id="list003" class="list">
        <ul id="ul003">
              <li class="defaultLink"><a href="all-examples.html">Examples</a></li>
              <li class="defaultLink"><a href="tutorials.html">Tutorials</a></li>
              <li class="defaultLink"><a href="demos.html">Demos</a></li>
              <li class="defaultLink"><a href="qdeclarativeexamples.html">QML Examples</a></li>
            </ul> 
          </div>
        </div>
      </div>
      <div class="wrap">
        <div class="toolbar">
          <div class="breadcrumb toolblock">
            <ul>
              <li class="first"><a href="index.html">Home</a></li>
              <!--  Bread crumbs goes here -->
              <li><a href="all-examples.html">Examples</a></li>              <li>SIP Dialog Example</li>            </ul>
          </div>
          <div class="toolbuttons toolblock">
            <ul>
              <li id="smallA" class="t_button">A</li>
              <li id="medA" class="t_button active">A</li>
              <li id="bigA" class="t_button">A</li>
              <li id="print" class="t_button"><a href="javascript:this.print();">
                <span>Print</span></a></li>
            </ul>
        </div>
        </div>
        <div class="content">
<div class="toc">
<h3><a name="toc">Contents</a></h3>
<ul>
<li class="level1"><a href="#dialog-class-definition">Dialog Class Definition</a></li>
<li class="level1"><a href="#dialog-class-implementation">Dialog Class Implementation</a></li>
<li class="level1"><a href="#the-function">The <tt>main()</tt> function</a></li>
</ul>
</div>
<h1 class="title">SIP Dialog Example</h1>
<span class="subtitle"></span>
<!-- $$$dialogs/sipdialog-description -->
<div class="descr"> <a name="details"></a>
<p>Files:</p>
<ul>
<li><a href="dialogs-sipdialog-dialog-cpp.html">dialogs/sipdialog/dialog.cpp</a></li>
<li><a href="dialogs-sipdialog-dialog-h.html">dialogs/sipdialog/dialog.h</a></li>
<li><a href="dialogs-sipdialog-main-cpp.html">dialogs/sipdialog/main.cpp</a></li>
<li><a href="dialogs-sipdialog-sipdialog-pro.html">dialogs/sipdialog/sipdialog.pro</a></li>
</ul>
<p>The SIP Dialog example shows how to create a dialog that is aware of the Windows Mobile SIP (Software Input Panel) and reacts to it.</p>
<table class="generic">
<tr class="odd topAlign"><td ><p><img src="images/sipdialog-closed.png" /></p></td><td ><p><img src="images/sipdialog-opened.png" /></p></td></tr>
</table>
<p>Sometimes it is necessary for a dialog to take the SIP into account, as the SIP may hide important input widgets. The SIP Dialog Example shows how a <tt>Dialog</tt> object, <tt>dialog</tt>, can be resized accordingly if the SIP is opened, by embedding the contents of <tt>dialog</tt> in a <a href="qscrollarea.html">QScrollArea</a>.</p>
<a name="dialog-class-definition"></a>
<h2>Dialog Class Definition</h2>
<p>The <tt>Dialog</tt> class is a subclass of <a href="qdialog.html">QDialog</a> that implements a public slot, <tt>desktopResized()</tt>, and a public function, <tt>reactToSIP()</tt>. Also, it holds a private instance of <a href="qrect.html">QRect</a>, <tt>desktopGeometry</tt>.</p>
<pre class="highlightedCode brush: cpp"> class Dialog : public QDialog
 {
     Q_OBJECT

 public:
     Dialog();
     void reactToSIP();

 private:
     QRect desktopGeometry;

 public slots:
     void desktopResized(int screen);
 };</pre>
<a name="dialog-class-implementation"></a>
<h2>Dialog Class Implementation</h2>
<p>In the constructor of <tt>Dialog</tt>, we start by obtaining the available geometry of the screen with <a href="qdesktopwidget.html#availableGeometry">availableGeometry()</a>. The parameter used is <tt>0</tt> to indicate that we require the primary screen.</p>
<pre class="highlightedCode brush: cpp"> Dialog::Dialog()
 {
     desktopGeometry = QApplication::desktop()-&gt;availableGeometry(0);

     setWindowTitle(tr(&quot;SIP Dialog Example&quot;));
     QScrollArea *scrollArea = new QScrollArea(this);
     QGroupBox *groupBox = new QGroupBox(scrollArea);
     groupBox-&gt;setTitle(tr(&quot;SIP Dialog Example&quot;));
     QGridLayout *gridLayout = new QGridLayout(groupBox);
     groupBox-&gt;setLayout(gridLayout);</pre>
<p>We set the window's title to &quot;SIP Dialog Example&quot; and declare a <a href="qscrollarea.html">QScrollArea</a> object, <tt>scrollArea</tt>. Next we instantiate a <a href="qgroupbox.html">QGroupBox</a>, <tt>groupBox</tt>, with <tt>scrollArea</tt> as its parent. The title of <tt>groupBox</tt> is also set to &quot;SIP Dialog Example&quot;. A <a href="qgridlayout.html">QGridLayout</a> object, <tt>gridLayout</tt>, is then used as <tt>groupBox</tt>'s layout.</p>
<p>We create a <a href="qlineedit.html">QLineEdit</a>, a <a href="qlabel.html">QLabel</a> and a <a href="qpushbutton.html">QPushButton</a> and we set the <a href="qwidget.html#minimumWidth-prop">minimumWidth</a> property to 220 pixels, respectively.</p>
<pre class="highlightedCode brush: cpp">     QLineEdit* lineEdit = new QLineEdit(groupBox);
     lineEdit-&gt;setText(tr(&quot;Open and close the SIP&quot;));
     lineEdit-&gt;setMinimumWidth(220);

     QLabel* label = new QLabel(groupBox);
     label-&gt;setText(tr(&quot;This dialog resizes if the SIP is opened&quot;));
     label-&gt;setMinimumWidth(220);

     QPushButton* button = new QPushButton(groupBox);
     button-&gt;setText(tr(&quot;Close Dialog&quot;));
     button-&gt;setMinimumWidth(220);</pre>
<p>Also, all three widgets' text are set accordingly. The <a href="qgridlayout.html#verticalSpacing-prop">verticalSpacing</a> property of <tt>gridLayout</tt> is set based on the height of <tt>desktopGeometry</tt>. This is to adapt to the different form factors of Windows Mobile. Then, we add our widgets to the layout.</p>
<pre class="highlightedCode brush: cpp">     if (desktopGeometry.height() &lt; 400)
         gridLayout-&gt;setVerticalSpacing(80);
     else
         gridLayout-&gt;setVerticalSpacing(150);

     gridLayout-&gt;addWidget(label);
     gridLayout-&gt;addWidget(lineEdit);
     gridLayout-&gt;addWidget(button);</pre>
<p>The <tt>scrollArea</tt>'s widget is set to <tt>groupBox</tt>. We use a <a href="qhboxlayout.html">QHBoxLayout</a> object, <tt>layout</tt>, to contain <tt>scrollArea</tt>. The <tt>Dialog</tt>'s layout is set to <tt>layout</tt> and the scroll area's horizontal scroll bar is turned off.</p>
<pre class="highlightedCode brush: cpp">     scrollArea-&gt;setWidget(groupBox);
     QHBoxLayout* layout = new QHBoxLayout();
     layout-&gt;addWidget(scrollArea);
     setLayout(layout);
     scrollArea-&gt;setHorizontalScrollBarPolicy(Qt::ScrollBarAlwaysOff);</pre>
<p>The following signals are connected to their respective slots:</p>
<ul>
<li><tt>button</tt>'s <a href="qabstractbutton.html#pressed">pressed()</a> signal to <a href="qapplication.html">QApplication</a>'s <a href="qapplication.html#closeAllWindows">closeAllWindows()</a> slot,</li>
<li><a href="qdesktopwidget.html">QDesktopWidget</a>'s <a href="qdesktopwidget.html#workAreaResized">workAreaResized()</a> signal to <tt>dialog</tt>'s <tt>desktopResized()</tt> slot.</li>
</ul>
<pre class="highlightedCode brush: cpp">     connect(button, SIGNAL(clicked()),
         qApp, SLOT(closeAllWindows()));
     connect(QApplication::desktop(), SIGNAL(workAreaResized(int)),
         this, SLOT(desktopResized(int)));
 }</pre>
<p>The <tt>desktopResized()</tt> function accepts an integer, <i>screen</i>, corresponding to the screen's index. We only invoke <tt>reactToSIP()</tt> if <i>screen</i> is the primary screen (e.g&#x2e; index = 0).</p>
<pre class="highlightedCode brush: cpp"> void Dialog::desktopResized(int screen)
 {
     if (screen != 0)
         return;
     reactToSIP();
 }</pre>
<p>The <tt>reactToSIP()</tt> function resizes <tt>dialog</tt> accordingly if the desktop's available geometry changed vertically, as this change signifies that the SIP may have been opened or closed.</p>
<pre class="highlightedCode brush: cpp"> void Dialog::reactToSIP()
 {
     QRect availableGeometry = QApplication::desktop()-&gt;availableGeometry(0);

     if (desktopGeometry != availableGeometry) {
         if (windowState() | Qt::WindowMaximized)
             setWindowState(windowState() &amp; ~Qt::WindowMaximized);

         setGeometry(availableGeometry);
     }

     desktopGeometry = availableGeometry;
 }</pre>
<p>If the height has decreased, we unset the maximized window state. Otherwise, we set the maximized window state. Lastly, we update <tt>desktopGeometry</tt> to the desktop's available geometry.</p>
<a name="the-function"></a>
<h2>The <tt>main()</tt> function</h2>
<p>The <tt>main()</tt> function for the SIP Dialog example instantiates <tt>Dialog</tt> and invokes its <a href="qdialog.html#exec">exec()</a> function.</p>
<pre class="highlightedCode brush: cpp"> int main(int argc, char *argv[])
 {
     QApplication app(argc, argv);
     Dialog dialog;
     return dialog.exec();
 }</pre>
<p><b>Note:</b> Although this example uses a dialog, the techniques used here apply to all top-level widgets respectively.</p>
</div>
<!-- @@@dialogs/sipdialog -->
        <div class="feedback t_button">
          [+] Documentation Feedback</div>
      </div>
    </div>
    </div> 
    <div class="ft">
      <span></span>
    </div>
  </div> 
  <div class="footer">
    <p>
      <acronym title="Copyright">&copy;</acronym> 2008-2010 Nokia Corporation and/or its
      subsidiaries. Nokia, Qt and their respective logos are trademarks of Nokia Corporation 
      in Finland and/or other countries worldwide.</p>
    <p>
      All other trademarks are property of their respective owners. <a title="Privacy Policy"
        href="http://qt.nokia.com/about/privacy-policy">Privacy Policy</a></p>
    <br />
    <p>
      Licensees holding valid Qt Commercial licenses may use this document in accordance with the      Qt Commercial License Agreement provided with the Software or, alternatively, in accordance      with the terms contained in a written agreement between you and Nokia.</p>
    <p>
      Alternatively, this document may be used under the terms of the <a href="http://www.gnu.org/licenses/fdl.html">GNU
      Free Documentation License version 1.3</a>
      as published by the Free Software Foundation.</p>
  </div>
  <div id="feedbackBox">
      <div id="feedcloseX" class="feedclose t_button">X</div>
    <form id="feedform" action="http://doc.qt.nokia.com/docFeedbck/feedback.php" method="get">
      <p id="noteHead">Thank you for giving your feedback.</p> <p class="note">Make sure it is related to this specific page. For more general bugs and 
      requests, please use the <a href="http://bugreports.qt.nokia.com/secure/Dashboard.jspa">Qt Bug Tracker</a>.</p>
      <p><textarea id="feedbox" name="feedText" rows="5" cols="40"></textarea></p>
      <p><input id="feedsubmit" class="feedclose" type="submit" name="feedback" /></p>
    </form>
  </div>
  <div id="blurpage">
  </div>
</body>
</html>
